# HIVE
HIVE is a novel tool to perform unpaired multi-transcriptomics integration. 

# System requirements
The first of three block of HIVE is a Variational Auto Encoder and it requires at least 8 GB of free memory space to run correctly.
It is implemented and tested on python 3.10.9.
Important library version are:
- tensorflow v2.11.0
- numpy v1.24.2

# Usage
```python HIVE1.0.py -h``` will give you the following help message:

```
  -h, --help            show this help message and exit
  -i INPUT_DIR, --input_dir INPUT_DIR
                        input directory in which to find the raw expression data for HIVE application, e.g. /home/HIVE_input_data/
  -o OUTPUT_DIR, --output_dir OUTPUT_DIR
                        output directory in which to save HIVE output files, e.g. /home/HIVE_results/
  -hz, --horizontal     indicate if an horizontal integration of two or more datasets is needed
  -rc REFERENCE_COLUMN, --reference_column REFERENCE_COLUMN
                        indicate the name of the column containing the gene names
  -ff FILE_FORMAT, --file_format FILE_FORMAT
                        indicate the input file/s extension
  -sep SEPARATOR, --separator SEPARATOR
                        indicate the separator character for columns in input data
  --minmax              indicate wether to apply or not the MinMaxScaler [0,1] range
  -c RFR_CLASSES, --rfr_classes RFR_CLASSES
                        indicate the vector corresponding to classes in your experimental design, MAINTAIN THE SAMPLE ORDER
  --shap                indicate if you want to use SHAP as feature importance calculation for HIVE gene selection
  --gini                indicate if you want to use SHAP as feature importance calculation for HIVE gene selection
  --pheno PHENO         indicate a numeric vector with numbers assigned to each sample (DO NOT CONSIDER CONTROLS) corresponding to phenotypic characteristics of interest, following their
                        original order, to explore the pheno. char. captured by latent features
  --deseq2 DESEQ2       path to the file generated by the R script using DESeq2 to obtain the lof2FC values
```

To run HIVE just for gene selection, please run the following command replacing the parameters accordingly (this step can take a while):
e.g.
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap
```
or 
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -hz -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap
```

To explore the latent features and their relationship with phenotypic characteristics, please try:
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap --pheno [0, 0, 0, 1, 1, 1] 
```
or 
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -hz -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap --pheno [0, 0, 0, 1, 1, 1]
```

To obtain the association of HIVE selected genes to condition, first run the ```calculate_log2fc.R``` script to obtain the log2FoldChange values for each gene, then try this:
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap --deseq2 /path/to/R/script/output_file
```
or 
```
python HIVE1.0.py -i /path/to/input_dir/ -o /path/to/output_dir -hz -rc 'ref' -ff .csv -sep ',' --minmax -c [0, 0, 0, 1, 1, 1, 2, 2, 2] --shap --deseq2 /path/to/R/script/output_file
```

You can also use all the parameters together.

